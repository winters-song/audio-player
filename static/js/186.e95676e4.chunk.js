"use strict";(self.webpackChunkaudio_player=self.webpackChunkaudio_player||[]).push([[186],{5186:(t,e,i)=>{i.r(e),i.d(e,{default:()=>o});var s=i(5043);class h{static compileShader(t,e,i){var s=t.createShader(i);if(!s)throw"could not create shader";if(t.shaderSource(s,e),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw"could not compile shader:"+t.getShaderInfoLog(s);return s}static createProgram(t,e,i){var s=t.createProgram();if(!s)throw"could not create program";if(t.attachShader(s,e),t.attachShader(s,i),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw"program failed to link:"+t.getProgramInfoLog(s);return s}static createProgramWithSources(t,e,i){const s=this.compileShader(t,e,t.VERTEX_SHADER),h=this.compileShader(t,i,t.FRAGMENT_SHADER);return this.createProgram(t,s,h)}static resizeCanvasToDisplaySize(t,e){e=e||1;const i=t.clientWidth*e|0,s=t.clientHeight*e|0;return(t.width!==i||t.height!==s)&&(t.width=i,t.height=s,!0)}}let r="Arial, Helvetica";class n{constructor(t){this.el=void 0,this.vertices=[],this.dVertices=[],this.refctx=void 0,this.gl=void 0,this.postctx=void 0,this.canvas=void 0,this.uResolution=void 0,this.uFrame=void 0,this.aPosition=void 0,this.smoothness=6,this.textList=["Hey!","I'm H2x","How are you?","Do you like it?","~~~LanRen~~~",":3"],this.textIndex=5,this.frame=0,this.timer=0,this.el=t,this.refctx=document.createElement("canvas").getContext("2d"),this.gl=document.createElement("canvas").getContext("webgl"),this.postctx=this.el.getContext("2d"),this.canvas=this.gl.canvas,this.textGeneration(),this.dVertices=new Array(4e4).fill(0);let e=h.createProgramWithSources(this.gl,"\n  attribute vec4 a_position;\n  uniform vec2 u_resolution;\n  uniform float u_frame;\n  varying vec4 v_position;\n  varying float v_frame;\n  void main () {\n    v_position = a_position;\n    v_frame = u_frame;\n    v_position.xy /= u_resolution;\n    v_position.y *= -1.0;\n    \n    v_position.xy *= 10.0;\n    v_position.z += cos(u_frame / 20.0 + v_position.x * 10.0) * sin(u_frame / 10.0 + v_position.y * 12.0) * 0.02;\n    v_position.xy /= (1.0 + v_position.z);\n    \n    gl_Position = vec4(v_position.xy, 0.0, 1.0);\n    gl_PointSize = 3.0;\n  }\n","\n  precision mediump float;\n  varying vec4 v_position;\n  varying float v_frame;\n  float pi = 3.141592653589793;\n  float hue2rgb(float f1, float f2, float hue) {\n      if (hue < 0.0)\n          hue += 1.0;\n      else if (hue > 1.0)\n          hue -= 1.0;\n      float res;\n      if ((6.0 * hue) < 1.0)\n          res = f1 + (f2 - f1) * 6.0 * hue;\n      else if ((2.0 * hue) < 1.0)\n          res = f2;\n      else if ((3.0 * hue) < 2.0)\n          res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\n      else\n          res = f1;\n      return res;\n  }\n\n  vec3 hsl2rgb(vec3 hsl) {\n      vec3 rgb;\n      \n      hsl.x = mod(hsl.x, 360.0);\n      hsl.x /= 360.0;\n\n      if (hsl.y == 0.0) {\n          rgb = vec3(hsl.z); // Luminance\n      } else {\n          float f2;\n\n          if (hsl.z < 0.5)\n              f2 = hsl.z * (1.0 + hsl.y);\n          else\n              f2 = hsl.z + hsl.y - hsl.y * hsl.z;\n\n          float f1 = 2.0 * hsl.z - f2;\n\n          rgb.r = hue2rgb(f1, f2, hsl.x + (1.0/3.0));\n          rgb.g = hue2rgb(f1, f2, hsl.x);\n          rgb.b = hue2rgb(f1, f2, hsl.x - (1.0/3.0));\n      }   \n      return rgb;\n  }\n  \n  void main () {\n    vec4 col = vec4(hsl2rgb(vec3(v_frame + v_position.z * 2000.0, 1.0, .5)) * v_position.w, 1.0);\n    gl_FragColor = col;\n  }\n");this.aPosition=this.gl.getAttribLocation(e,"a_position"),this.uResolution=this.gl.getUniformLocation(e,"u_resolution"),this.uFrame=this.gl.getUniformLocation(e,"u_frame");let i=this.gl.createBuffer();this.gl.useProgram(e),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i),this.gl.vertexAttribPointer(this.gl.getAttribLocation(e,"a_position"),4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosition)}render(){if(this.postctx){this.frame++,this.gl.uniform1f(this.uFrame,this.frame),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.postctx.canvas.width===this.postctx.canvas.offsetWidth&&this.postctx.canvas.height===this.postctx.canvas.offsetHeight||(this.canvas.width=this.postctx.canvas.width=this.postctx.canvas.offsetWidth,this.canvas.height=this.postctx.canvas.height=this.postctx.canvas.offsetHeight,this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.uniform2fv(this.uResolution,[this.canvas.width,this.canvas.height]));for(let t=0;t<this.vertices.length;t+=4){let e=t,i=t+1,s=t+3;this.dVertices[e]-=(this.dVertices[e]-this.vertices[e])/this.smoothness,this.dVertices[i]-=(this.dVertices[i]-this.vertices[i])/this.smoothness,this.dVertices[s]-=(this.dVertices[s]-this.vertices[s])/this.smoothness}this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.dVertices),this.gl.STATIC_DRAW),this.gl.drawArrays(this.gl.POINTS,0,this.dVertices.length/4),this.postctx.globalAlpha=.1,this.postctx.globalCompositeOperation="source-over",this.postctx.drawImage(this.canvas,0,0),this.postctx.globalCompositeOperation="lighten",this.postctx.globalAlpha=1,this.postctx.filter="blur(8px)",this.postctx.drawImage(this.canvas,0,0),this.postctx.filter="blur(0)",this.timer=requestAnimationFrame((()=>this.render()))}}stop(){cancelAnimationFrame(this.timer)}setText(t){if(!this.refctx)return;this.refctx.font="".concat(24,"px ").concat(r),this.refctx.canvas.width=this.refctx.measureText(t).width||100,this.refctx.canvas.height=24,this.refctx.font="".concat(24,"px ").concat(r),this.refctx.textBaseline="top",this.refctx.clearRect(0,0,this.refctx.canvas.width,this.refctx.canvas.height),this.refctx.fillStyle="#fff",this.refctx.fillText(t,0,0);let{data:e}=this.refctx.getImageData(0,0,this.refctx.canvas.width,this.refctx.canvas.height);this.vertices=new Array(4e4).fill(0);for(let i=0;i<e.length;i+=4){let t=i/4%this.refctx.canvas.width-this.refctx.canvas.width/2,s=(i/4/this.refctx.canvas.width|0)%this.refctx.canvas.height-this.refctx.canvas.height/2,h=e[i]?e[i+3]/255:0;this.vertices[i]=t,this.vertices[i+1]=s,this.vertices[i+3]=h}}textGeneration(){this.setText(this.textList[this.textIndex]),setTimeout((()=>{this.textIndex++,this.textIndex===this.textList.length&&(this.textIndex=0),this.textGeneration()}),1e3)}}var a=i(579);const o=t=>{const e=(0,s.useRef)(null),[i,h]=(0,s.useState)(!0),r=(0,s.useRef)(null);(0,s.useEffect)((()=>{const t=e.current;t&&setTimeout((()=>{let e=new n(t);r.current=e,e.render()}),1e3)}),[]);return(0,a.jsx)("div",{children:(0,a.jsx)("canvas",{ref:e,id:"canvas",onClick:()=>(t=>{t?r.current.stop():r.current.render(),h(!t)})(i)})})}}}]);
//# sourceMappingURL=186.e95676e4.chunk.js.map